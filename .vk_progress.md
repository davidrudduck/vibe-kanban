# Validation Steps Feature Progress

## Current Status: **needs-review**

PR: https://github.com/davidrudduck/vibe-kanban/pull/70

## Completed Items

- [x] Database migration for validation_steps columns (tasks and projects)
- [x] Task model with validation_steps field and helper methods
- [x] `to_enhanced_prompt()` method that formats validation steps as numbered list
- [x] Updated all Task SQL queries (9+ queries)
- [x] Project model with default_validation_steps field (for future use)
- [x] container.rs updated to use `to_enhanced_prompt()` instead of `to_prompt()`
- [x] API routes updated for validation_steps handling
- [x] Frontend textarea for validation steps in TaskFormDialog
- [x] TypeScript types regenerated
- [x] All checks passing (`npm run check`)
- [x] SQLx query cache updated for db crate
- [x] E2E browser testing verified:
  - Task creation with validation steps works
  - Validation steps persist to database
  - Validation steps load correctly when editing task

## Implementation Details

### How Validation Steps Work

1. **User enters validation steps** in the task form (one per line in textarea)
2. **Frontend converts** line-separated text to JSON array for storage
3. **Backend stores** as JSON string in SQLite `validation_steps` column
4. **When agent starts**, `to_enhanced_prompt()` appends validation requirements:
   ```bash
   === VALIDATION REQUIREMENTS ===
   Before marking this task complete, verify:
   1. Run npm run check
   2. Verify no TypeScript errors
   3. Test in browser
   ```

### Files Modified

- `crates/db/migrations/20251212000000_add_validation_steps.sql`
- `crates/db/src/models/task.rs`
- `crates/db/src/models/project.rs`
- `crates/services/src/services/container.rs`
- `crates/services/src/services/assignment_handler.rs`
- `crates/server/src/routes/tasks.rs`
- `crates/server/src/routes/plan_steps.rs`
- `crates/server/src/mcp/task_server.rs`
- `frontend/src/components/dialogs/tasks/TaskFormDialog.tsx`
- `frontend/src/components/tasks/TaskDetails/preview/NoServerContent.tsx`
- `frontend/src/pages/ProjectTasks.tsx`
- `crates/db/.sqlx/` (SQLx query cache)
- `shared/types.ts` (auto-generated)

## Remaining Work

- [ ] Project settings UI for default_validation_steps (deferred to future phase)
- [ ] Consider adding validation steps to task details view (read-only display)

## Next Session Recommendations

1. Review PR and merge if approved
2. Consider Phase B implementation (project-level defaults for validation steps)
3. Consider adding a visual indicator when a task has validation steps
