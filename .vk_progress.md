# WebSocket Real-Time Update Fix - Session Progress

## Status: COMPLETE

## Issue
Tasks were not appearing in real-time after creation. Users had to refresh the page to see newly created tasks.

## Root Cause
The backend uses `tokio::spawn()` in `crates/services/src/services/events.rs:177` for broadcasting events. This makes broadcasts async and fire-and-forget, meaning the HTTP response returns before the WebSocket broadcast completes.

## Solution Implemented
**Optimistic UI Update (Option A)** - Frontend immediately updates local state after successful REST API response instead of waiting for WebSocket broadcast.

### Files Changed
1. `frontend/src/contexts/TaskOptimisticContext.tsx` - NEW: Global callback registry for cross-component optimistic updates
2. `frontend/src/hooks/useJsonPatchWsStream.ts` - Added `patchData` function for programmatic state updates
3. `frontend/src/hooks/useProjectTasks.ts` - Register optimistic callback globally, export `addTaskOptimistically`
4. `frontend/src/hooks/useTaskMutations.ts` - Use global registry when context unavailable (for modals)
5. `frontend/src/pages/ProjectTasks.tsx` - Wrap with `TaskOptimisticProvider`

## Testing
- [x] E2E tested with Playwright browser automation
- [x] Tasks appear immediately after creation
- [x] No duplicate tasks when WebSocket eventually broadcasts
- [x] TypeScript type checking passes

## PR
https://github.com/davidrudduck/vibe-kanban/pull/69
