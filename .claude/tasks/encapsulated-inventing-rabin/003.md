---
name: Integrate ModelChangeWarningDialog into TaskFollowUpSection
status: completed
created: 2026-01-23T08:40:46Z
updated: 2026-01-23T10:05:00Z
depends_on: [001, 002]
parallel: false
conflicts_with: []
---

# Task: Integrate ModelChangeWarningDialog into TaskFollowUpSection

## Description
Wire up the ModelChangeWarningDialog component to TaskFollowUpSection so that when users select a variant with a different model, they see a warning dialog before the change is applied.

## Acceptance Criteria
- [x] ModelChangeWarningDialog imported
- [x] Hook destructuring updated to use new exports
- [x] State added for pendingVariant and showModelWarning
- [x] handleVariantChange wrapper intercepts variant changes
- [x] handleConfirmModelChange applies pending variant
- [x] VariantSelector wired to handleVariantChange
- [x] Dialog renders at end of component

## Technical Details

**File Location**: `frontend/src/components/tasks/TaskFollowUpSection.tsx`

**Import Addition**:
```typescript
import { ModelChangeWarningDialog } from '@/components/dialogs/ModelChangeWarningDialog';
```

**Hook Update**:
```typescript
const { selectedVariant, setSelectedVariant, currentProfile, wouldModelChange, previousVariantInfo } =
  useDefaultVariant({ processes, profiles: profiles ?? null });
```

**State Addition**:
```typescript
const [pendingVariant, setPendingVariant] = useState<string | null>(null);
const [showModelWarning, setShowModelWarning] = useState(false);
```

**Handler Functions**:
```typescript
const handleVariantChange = useCallback((newVariant: string | null) => {
  if (wouldModelChange(newVariant)) {
    setPendingVariant(newVariant);
    setShowModelWarning(true);
  } else {
    setSelectedVariant(newVariant);
  }
}, [wouldModelChange, setSelectedVariant]);

const handleConfirmModelChange = useCallback(() => {
  if (pendingVariant !== null) setSelectedVariant(pendingVariant);
  setPendingVariant(null);
  setShowModelWarning(false);
}, [pendingVariant, setSelectedVariant]);
```

**VariantSelector Update**:
```typescript
<VariantSelector onChange={handleVariantChange} ... />
```

**Dialog Render** (at end of component):
```typescript
<ModelChangeWarningDialog
  open={showModelWarning}
  onOpenChange={setShowModelWarning}
  previousVariant={previousVariantInfo.variant}
  previousModel={previousVariantInfo.model}
  newVariant={pendingVariant ?? 'DEFAULT'}
  newModel={/* extract using getModelFromVariantConfig */}
  onConfirm={handleConfirmModelChange}
/>
```

## Dependencies
- Task 001: ModelChangeWarningDialog component must exist
- Task 002: useDefaultVariant hook must have new exports

## Effort Estimate
- Size: S
- Hours: 1
- Parallel: false

## Definition of Done
- [x] Dialog imported successfully
- [x] Hook destructuring includes new exports
- [x] State management for pending variant works
- [x] handleVariantChange intercepts and checks model change
- [x] Dialog appears when model would change
- [x] Cancel keeps original variant
- [x] Confirm applies new variant
- [x] No TypeScript errors
- [x] UI flow tested manually
