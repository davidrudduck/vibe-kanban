---
name: Write test for orphaned task count
status: completed
created: 2026-01-12T09:52:07Z
updated: 2026-01-15T16:45:00Z
depends_on: []
conflicts_with: []
---

# Task: Write test for orphaned task count

## Description
Create a test in `crates/db/src/models/task/sync.rs` that verifies the `count_orphaned_for_project()` function correctly counts tasks with `shared_task_id` values.

## Acceptance Criteria
- [x] Test creates a project without `remote_project_id`
- [x] Test creates a task with `shared_task_id`
- [x] Test asserts that `count_orphaned_for_project()` returns 1
- [x] Test uses `create_test_pool()` for database setup
- [x] Test passes when run with `cargo test`

## Technical Details
- Location: `crates/db/src/models/task/sync.rs` (in `#[cfg(test)] mod tests`)
- Use `db::test_utils::create_test_pool()` for test database (uses local `setup_test_pool()` which provides equivalent functionality)
- Function signature: `async fn test_count_orphaned_for_project()`

## Dependencies
- No external dependencies

## Effort Estimate
- Size: XS
- Hours: 0.5

## Definition of Done
- [x] Test code written
- [x] Test compiles without errors
- [x] Test is documented with clear comments
